import{M as S,N as H,O as w,P as ee,Q as te,B as oe,G as N,R,A as Q,S as ae,u as h,T as ne,d as le,r as $,c as A,a as y,w as _,U as L,m as C,V as se,W as ie,e as I,X as ue,Y as W,h as E,Z as F,F as U,s as re,f as D,g as G,$ as ce,t as q,b as O,j as J,o as b,_ as de}from"./index-BrUR08XE.js";function X(e,t){return ee()?(te(e,t),!0):!1}const P=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const pe=Object.prototype.toString,fe=e=>pe.call(e)==="[object Object]";function ve(e){let t;function a(){return t||(t=e()),t}return a.reset=async()=>{const p=t;t=void 0,p&&await p},a}function M(e){return Array.isArray(e)?e:[e]}function me(e,t,a={}){const{immediate:p=!0,immediateCallback:v=!1}=a,r=S(!1);let m;function o(){m&&(clearTimeout(m),m=void 0)}function n(){r.value=!1,o()}function l(...i){v&&e(),o(),r.value=!0,m=setTimeout(()=>{r.value=!1,m=void 0,e(...i)},w(t))}return p&&(r.value=!0,P&&l()),X(n),{isPending:H(r),start:l,stop:n}}function ye(e,t,a){return oe(e,t,{...a,immediate:!0})}const ge=P?window:void 0,Y=P?window.navigator:void 0;function he(e){var t;const a=w(e);return(t=a==null?void 0:a.$el)!==null&&t!==void 0?t:a}function Z(...e){const t=[],a=()=>{t.forEach(o=>o()),t.length=0},p=(o,n,l,i)=>(o.addEventListener(n,l,i),()=>o.removeEventListener(n,l,i)),v=N(()=>{const o=M(w(e[0])).filter(n=>n!=null);return o.every(n=>typeof n!="string")?o:void 0}),r=ye(()=>{var o,n;return[(o=(n=v.value)===null||n===void 0?void 0:n.map(l=>he(l)))!==null&&o!==void 0?o:[ge].filter(l=>l!=null),M(w(v.value?e[1]:e[0])),M(h(v.value?e[2]:e[1])),w(v.value?e[3]:e[2])]},([o,n,l,i])=>{if(a(),!(o!=null&&o.length)||!(n!=null&&n.length)||!(l!=null&&l.length))return;const g=fe(i)?{...i}:i;t.push(...o.flatMap(k=>n.flatMap(T=>l.map(c=>p(k,T,c,g)))))},{flush:"post"}),m=()=>{r(),a()};return X(a),m}function _e(){const e=S(!1),t=ae();return t&&Q(()=>{e.value=!0},t),e}function z(e){const t=_e();return N(()=>(t.value,!!e()))}function K(e,t={}){const{controls:a=!1,navigator:p=Y}=t,v=z(()=>p&&"permissions"in p),r=S(),m=typeof e=="string"?{name:e}:e,o=S(),n=()=>{var i,g;o.value=(i=(g=r.value)===null||g===void 0?void 0:g.state)!==null&&i!==void 0?i:"prompt"};Z(r,"change",n,{passive:!0});const l=ve(async()=>{if(v.value){if(!r.value)try{r.value=await p.permissions.query(m)}catch{r.value=void 0}finally{n()}if(a)return ne(r.value)}});return l(),a?{state:o,isSupported:v,query:l}:o}function xe(e={}){const{navigator:t=Y,read:a=!1,source:p,copiedDuring:v=1500,legacy:r=!1}=e,m=z(()=>t&&"clipboard"in t),o=K("clipboard-read"),n=K("clipboard-write"),l=N(()=>m.value||r),i=S(""),g=S(!1),k=me(()=>g.value=!1,v,{immediate:!1});async function T(){let u=!(m.value&&V(o.value));if(!u)try{i.value=await t.clipboard.readText()}catch{u=!0}u&&(i.value=x())}l.value&&a&&Z(["copy","cut"],T,{passive:!0});async function c(u=w(p)){if(l.value&&u!=null){let d=!(m.value&&V(n.value));if(!d)try{await t.clipboard.writeText(u)}catch{d=!0}d&&f(u),i.value=u,g.value=!0,k.start()}}function f(u){const d=document.createElement("textarea");d.value=u,d.style.position="absolute",d.style.opacity="0",document.body.appendChild(d),d.select(),document.execCommand("copy"),d.remove()}function x(){var u,d,s;return(u=(d=document)===null||d===void 0||(s=d.getSelection)===null||s===void 0||(s=s.call(d))===null||s===void 0?void 0:s.toString())!==null&&u!==void 0?u:""}function V(u){return u==="granted"||u==="prompt"}return{isSupported:l,text:R(i),copied:R(g),copy:c}}const Ce={style:{"max-width":"1000px",margin:"0 auto"}},be={style:{display:"flex","align-items":"center",gap:"4px","justify-content":"space-between"}},we=["onClick"],Se={style:{display:"flex","align-items":"center",gap:"4px"}},ke={class:"right-action"},Te=le({__name:"Todo",setup(e){const{copy:t}=xe(),a=$(""),p=$("all"),v=$(!1),r=$([{id:0,title:"todo页面",status:1}]),m=[{label:"全部",value:"all"},{label:"未完成",value:1},{label:"已完成",value:2}];async function o(){const c=await C.getDataList("todos",{status:p.value==="all"?[1,2]:p.value,archive:v.value?1:0});r.value=c||[]}async function n(){await C.addDataItem("todos",{title:a.value,status:1}),a.value="",o()}async function l(){const c=await C.getOfflineData("todos");t(JSON.stringify(c))}async function i(){const c=await navigator.clipboard.readText(),f=JSON.parse(c)||[];for(const x of f)x.add?C.addDataItem("todos",{title:x.title,status:x.status}):C.updateDataItem("todos",x)}async function g(c){await C.deleteDataItem("todos",c),o()}async function k(c){c.archive||(await C.updateDataItem("todos",{...c,status:c.status===1?2:1}),o())}async function T(c){await C.updateDataItem("todos",{...c,archive:c.archive===1?0:1}),o()}return Q(()=>{o()}),(c,f)=>{const x=O("ElText"),V=O("Finished"),u=O("el-icon"),d=O("Close");return b(),A("div",Ce,[y(h(L),null,{default:_(()=>[y(h(se),{clearable:"",placeholder:"创建待办项",modelValue:a.value,"onUpdate:modelValue":f[0]||(f[0]=s=>a.value=s),onKeydown:ie(n,["enter"])},null,8,["modelValue"])]),_:1}),y(h(L),{class:"list-filter"},{default:_(()=>[I("div",be,[y(h(ue),{modelValue:p.value,"onUpdate:modelValue":f[1]||(f[1]=s=>p.value=s),placeholder:"默认",options:m,style:{width:"100px"},onChange:o},null,8,["modelValue"]),y(h(W),{type:"primary",onClick:l},{default:_(()=>f[3]||(f[3]=[E("复制")])),_:1}),y(h(W),{type:"primary",onClick:i},{default:_(()=>f[4]||(f[4]=[E("粘贴")])),_:1}),y(h(F),{modelValue:v.value,"onUpdate:modelValue":f[2]||(f[2]=s=>v.value=s),onChange:o},{default:_(()=>f[5]||(f[5]=[E("显示已归档")])),_:1},8,["modelValue"])])]),_:1}),y(h(L),{class:"list-box"},{default:_(()=>[(b(!0),A(U,null,re(r.value,(s,j)=>(b(),A(U,{key:j},[j!=0?(b(),D(h(ce),{key:0,style:{margin:"10px 0"}})):G("",!0),I("div",{onClick:B=>k(s),style:{height:"32px",display:"flex","align-items":"center","justify-content":"space-between",padding:"5px 0"}},[I("div",Se,[s.archive?G("",!0):(b(),D(h(F),{key:0,"model-value":s.status,"true-value":2},null,8,["model-value"])),s.status===2&&!s.archive?(b(),D(x,{key:1,tag:"del",type:"info",style:{cursor:"pointer"}},{default:_(()=>[E(q(s.title),1)]),_:2},1024)):(b(),D(x,{key:2,style:{cursor:"pointer"}},{default:_(()=>[E(q(s.title),1)]),_:2},1024))]),I("div",ke,[y(u,{style:{cursor:"pointer"},onClick:J(B=>T(s),["stop"])},{default:_(()=>[y(V)]),_:2},1032,["onClick"]),y(u,{style:{cursor:"pointer"},onClick:J(B=>g(s.id),["stop"])},{default:_(()=>[y(d)]),_:2},1032,["onClick"])])],8,we)],64))),128))]),_:1})])}}}),Ve=de(Te,[["__scopeId","data-v-4cce1ebe"]]);export{Ve as default};
