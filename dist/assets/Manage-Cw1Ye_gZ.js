import"./FormItem.vue_vue_type_style_index_0_scoped_4a704015_lang-Bw0nEf3B.js";import{m as y}from"./manageService-DCVQeDW4.js";import{d as q,r as w,m as W,h as V,g as p,c as _,f as B,j as I,a,o as n,q as Z,F as N,b as e,e as L,w as l,k as J,t as P,s as Q,v as h,x as ee,_ as le,p as ue}from"./index-DDIkWaXq.js";import"./httpService-Dramfhxh.js";const M=!1,de={style:{display:"flex","align-items":"center","justify-content":"space-between"}},ie=q({__name:"Database",setup(H){const i=w(!1),C=async()=>{const{connected:r}=await y.getDatabaseConnectStatus();i.value=r},u=async()=>{const{connected:r}=await y.connectDatabase();i.value=r},g=async()=>{const{connected:r}=await y.closeConnection();i.value=r},m=r=>{r?u():g()};return W(()=>{C()}),(r,k)=>{const T=a("el-switch");return n(),V("div",de,[k[1]||(k[1]=p(" 数据库 ")),I(M)?(n(),_(T,{key:0,modelValue:i.value,"onUpdate:modelValue":k[0]||(k[0]=D=>i.value=D),onChange:m},null,8,["modelValue"])):B("",!0)])}}}),ce=["onClick"],me={style:{display:"flex",gap:"5px"}},re={key:0},_e={class:"dialog-footer"},pe=q({__name:"DataBaseTableNav",emits:["select"],setup(H,{emit:i}){const C=i,u=[{title:"cid",key:"cid",isEdit:!1},{title:"name",key:"name"},{title:"type",key:"type"},{title:"notnull",key:"notnull"},{title:"dflt_value",key:"dflt_value"},{title:"pk",key:"pk"},{title:"column",key:"column"}],g=w(),m=w([]),r=w([]),k=Z(()=>[...m.value,...r.value]),T=async()=>{const d=await y.getAllTable()||[];g.value=d},D=async d=>{await y.delTable(d),T()},O=d=>{C("select",d.name)},G=async()=>{if(!v.value.name)return;const d=k.value.filter(t=>t.isAdd);await y.addTable(v.value.name,v.value.title,d),T()},x=async()=>{const d=k.value.filter(t=>t.isAdd);await y.addTableColumn(v.value.name,d)},c=async d=>{m.value=await y.getTableInfo(d)},S=async()=>{await y.getAllDataJson()},$=w(!1),v=w({name:""}),E=w(""),R=()=>{$.value=!1,E.value="",r.value=[]},Y=d=>{d?(E.value=d.name,v.value={...d},c(d.name)):(v.value={name:""},m.value=[]),$.value=!0},z=async()=>{E.value?E.value!==v.value.name||await x():await G(),R()},X=()=>{r.value.push({isAdd:!0})};return W(()=>{T()}),(d,t)=>{const A=a("el-button"),j=a("el-text"),F=a("el-link"),o=a("el-input"),f=a("el-form-item"),b=a("el-option"),te=a("el-select"),ae=a("el-table-column"),ne=a("el-table"),oe=a("el-form"),se=a("el-dialog");return n(),V(N,null,[e(A,{size:"small",type:"primary",onClick:T},{default:l(()=>t[6]||(t[6]=[p("获取表")])),_:1}),I(M)?(n(),_(A,{key:0,size:"small",onClick:t[0]||(t[0]=s=>Y())},{default:l(()=>t[7]||(t[7]=[p("添加数据表")])),_:1})):B("",!0),I(M)?(n(),_(A,{key:1,size:"small",onClick:t[1]||(t[1]=s=>S())},{default:l(()=>t[8]||(t[8]=[p("导出")])),_:1})):B("",!0),L("div",null,[(n(!0),V(N,null,J(g.value,s=>(n(),V("div",null,[L("div",{class:"table-item",onClick:U=>O(s)},[e(j,{class:"mx-1"},{default:l(()=>[p(P(s.name),1)]),_:2},1024),L("div",me,[I(M)?(n(),_(F,{key:0,type:"primary",icon:I(h),onClick:Q(U=>Y(s),["stop"])},null,8,["icon","onClick"])):B("",!0),I(M)?(n(),_(F,{key:1,type:"danger",icon:I(ee),onClick:Q(U=>D(s.name),["stop"])},null,8,["icon","onClick"])):B("",!0)])],8,ce)]))),256))]),e(se,{modelValue:$.value,"onUpdate:modelValue":t[5]||(t[5]=s=>$.value=s),title:"添加数据表",width:"700","before-close":R},{footer:l(()=>[L("div",_e,[e(A,{onClick:t[4]||(t[4]=s=>$.value=!1)},{default:l(()=>t[10]||(t[10]=[p("取消")])),_:1}),e(A,{type:"primary",onClick:z},{default:l(()=>t[11]||(t[11]=[p(" 确定 ")])),_:1})])]),default:l(()=>[e(oe,{model:v.value,"label-width":"auto",style:{"max-width":"600px"}},{default:l(()=>[e(f,{label:"数据表"},{default:l(()=>[e(o,{modelValue:v.value.name,"onUpdate:modelValue":t[2]||(t[2]=s=>v.value.name=s)},null,8,["modelValue"])]),_:1}),e(f,{label:"数据表名"},{default:l(()=>[e(o,{modelValue:v.value.title,"onUpdate:modelValue":t[3]||(t[3]=s=>v.value.title=s)},null,8,["modelValue"])]),_:1}),e(ne,{data:k.value,style:{width:"100%"},border:""},{default:l(()=>[(n(),V(N,null,J(u,s=>e(ae,{label:s.title,prop:s.key},{default:l(U=>[U.row.isAdd&&s.isEdit!==!1?(n(),V("div",re,[s.key==="type"?(n(),_(te,{key:0,modelValue:U.row[s.key],"onUpdate:modelValue":K=>U.row[s.key]=K},{default:l(()=>[e(b,{value:"TEXT"}),e(b,{value:"CLOB"}),e(b,{value:"INTEGER"}),e(b,{value:"CHAR"}),e(b,{value:"NULL"}),e(b,{value:"REAL"}),e(b,{value:"BLOB"}),e(b,{value:"DATETIME"}),e(b,{value:"DATE"}),e(b,{value:"HHH"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):(n(),_(o,{key:1,modelValue:U.row[s.key],"onUpdate:modelValue":K=>U.row[s.key]=K},null,8,["modelValue","onUpdate:modelValue"]))])):(n(),_(j,{key:1},{default:l(()=>[p(P(U.row[s.key]),1)]),_:2},1024))]),_:2},1032,["label","prop"])),64))]),_:1},8,["data"]),e(A,{class:"mt-4",style:{width:"100%"},onClick:X},{default:l(()=>t[9]||(t[9]=[p(" 添加字段 ")])),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}}),ve=le(pe,[["__scopeId","data-v-e11af274"]]),fe={class:"card-header"},ye={key:0},ke={class:"dialog-footer"},be=q({__name:"TableData",props:{name:{},tableInfoColumn:{}},setup(H){const i=H,C=w(),u=w({}),g=Z(()=>i.tableInfoColumn?i.tableInfoColumn:[]),m=async()=>{C.value=await y.getDataList(i.name,{})},r=async()=>{await y.addDataItem(i.name,u.value),m()},k=async()=>{await y.updateDataItem(i.name,u.value),m()},T=async x=>{await y.deleteDataItem(i.name,x.id),m()},D=w(!1),O=x=>{u.value=x?{...x}:{},D.value=!0},G=async()=>{u.value.id?await k():await r(),D.value=!1};return ue(()=>i.name,()=>m()),m(),(x,c)=>{const S=a("el-button"),$=a("el-link"),v=a("el-text"),E=a("el-table-column"),R=a("el-table"),Y=a("el-card"),z=a("el-input"),X=a("el-option"),d=a("el-select"),t=a("el-date-picker"),A=a("el-form-item"),j=a("el-form"),F=a("el-dialog");return n(),V(N,null,[e(Y,{shadow:"always",title:""},{header:l(()=>[L("div",fe,[L("span",null,"数据表("+P(x.name)+")数据",1)])]),default:l(()=>[I(M)?(n(),_(S,{key:0,onClick:c[0]||(c[0]=o=>O())},{default:l(()=>c[3]||(c[3]=[p("添加")])),_:1})):B("",!0),e(R,{data:C.value,style:{width:"100%"},border:""},{default:l(()=>[(n(!0),V(N,null,J(g.value,o=>(n(),_(E,{label:o.title,prop:o.key},{default:l(f=>[o.key==="action"?(n(),V("div",ye,[e($,{type:"primary",icon:I(h),onClick:b=>O(f.row)},{default:l(()=>c[4]||(c[4]=[p(" 修改 ")])),_:2},1032,["icon","onClick"]),e($,{type:"danger",icon:I(ee),style:{"margin-left":"10px"},onClick:b=>T(f.row)},{default:l(()=>c[5]||(c[5]=[p(" 删除 ")])),_:2},1032,["icon","onClick"])])):(n(),_(v,{key:1},{default:l(()=>[p(P(f.row[o.key]),1)]),_:2},1024))]),_:2},1032,["label","prop"]))),256))]),_:1},8,["data"])]),_:1}),e(F,{modelValue:D.value,"onUpdate:modelValue":c[2]||(c[2]=o=>D.value=o)},{footer:l(()=>[L("div",ke,[e(S,{onClick:c[1]||(c[1]=o=>D.value=!1)},{default:l(()=>c[6]||(c[6]=[p("取消")])),_:1}),e(S,{type:"primary",onClick:G},{default:l(()=>c[7]||(c[7]=[p(" 确定 ")])),_:1})])]),default:l(()=>[e(j,{model:u.value,"label-width":"auto",style:{"max-width":"600px"}},{default:l(()=>[(n(!0),V(N,null,J(x.tableInfoColumn,o=>(n(),_(A,{label:o.title},{default:l(()=>[o.type==="CLOB"?(n(),_(z,{key:0,modelValue:u.value[o.key],"onUpdate:modelValue":f=>u.value[o.key]=f,rows:2,type:"textarea",placeholder:"Please input"},null,8,["modelValue","onUpdate:modelValue"])):o.type==="CHAR"?(n(),_(d,{key:1,modelValue:u.value[o.key],"onUpdate:modelValue":f=>u.value[o.key]=f,placeholder:"Select"},{default:l(()=>[e(X,{label:"测试",value:"ce"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):o.type==="DATETIME"?(n(),_(t,{key:2,modelValue:u.value[o.key],"onUpdate:modelValue":f=>u.value[o.key]=f,type:"date","value-format":"YYYY-MM-DD",placeholder:"Pick a day"},null,8,["modelValue","onUpdate:modelValue"])):(n(),_(z,{key:3,modelValue:u.value[o.key],"onUpdate:modelValue":f=>u.value[o.key]=f,disabled:o.key==="id"},null,8,["modelValue","onUpdate:modelValue","disabled"]))]),_:2},1032,["label"]))),256))]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}}),we={class:"manage-page"},Ce=q({__name:"Manage",setup(H){const i=w(),C=w({name:"",list:[]}),u=async g=>{C.value.list=await y.getTableInfo(g),C.value.name=g,i.value=C.value.list.map(m=>({title:m.name,key:m.name,type:m.type}))};return(g,m)=>{const r=a("el-card"),k=a("el-col"),T=a("el-row");return n(),V("div",we,[e(T,{gutter:20},{default:l(()=>[e(k,{span:6},{default:l(()=>[e(r,{shadow:"always"},{header:l(()=>[e(ie)]),default:l(()=>[e(ve,{onSelect:u})]),_:1})]),_:1}),e(k,{span:18},{default:l(()=>[e(be,{name:C.value.name,tableInfoColumn:i.value},null,8,["name","tableInfoColumn"])]),_:1})]),_:1})])}}}),De=le(Ce,[["__scopeId","data-v-1db595b0"]]);export{De as default};
