import{K as m,d as h,r as i,G as y,c as V,a as n,w as r,b as u,F as L,m as C,u as P,p as U,e as x,o as B}from"./index-BrLrKHRe.js";class D{async upload(t){const l=new FormData;return l.append("file",t.file),l.append("name","123"),m.post("/api/file/upload",l)}async delFile(t){return m.post("/api/file/del",t)}}const p=new D,F=["src"],I=h({__name:"img",setup(f){const t=async e=>(await p.upload({file:e,name:"12"}),!1),l=i([]),c=i(""),o=i(!1),_=y(()=>"https://liujinzhu333.github.io/album/"),v=async(e,a)=>{try{return await p.delFile({id:e.id,name:e.name,filename:e.filename}),!0}catch{return console.log(e,a),!1}},g=e=>{c.value=e.url,o.value=!0};return(async()=>{const e=await C.getDataList("files");console.log(e),l.value=e.map(a=>({name:a.originalname,filename:a.filename,url:`${_.value}${a.path}`,id:a.id}))})(),(e,a)=>{const d=u("el-icon"),w=u("el-upload"),b=u("el-dialog");return B(),V(L,null,[n(w,{"file-list":l.value,"onUpdate:fileList":a[0]||(a[0]=s=>l.value=s),"list-type":"picture-card","on-preview":g,"before-remove":v,"before-upload":t},{default:r(()=>[n(d,null,{default:r(()=>[n(P(U))]),_:1})]),_:1},8,["file-list"]),n(b,{modelValue:o.value,"onUpdate:modelValue":a[1]||(a[1]=s=>o.value=s)},{default:r(()=>[x("img",{"w-full":"",src:c.value,alt:"Preview Image"},null,8,F)]),_:1},8,["modelValue"])],64)}}});export{I as default};
