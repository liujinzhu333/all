import{K as C,d as N,r as i,G as S,c as m,a as l,w as o,b as f,F as z,m as E,u,p as j,e as c,g as k,L as G,i as y,k as K,I as O,o as v,_ as R}from"./index-CoDhunZ9.js";import{_ as q}from"./EditModal.vue_vue_type_script_setup_true_lang-Cz0eI_QH.js";class A{async upload(s){const n=new FormData;return n.append("file",s.file),n.append("name","123"),C.post("/api/file/upload",n)}async delFile(s){return C.post("/api/file/del",s)}}const V=new A,H={class:"custom-card"},J=["src"],M={class:"el-upload-list__item-actions"},Q=["onClick"],T=["onClick"],W=["onClick"],X={class:"view-box"},Y=["src"],Z=N({__name:"img",setup(U){const s=i([]),n=i(""),r=i(!1),_=i(!1),p=i(!1),g=i(),$=S(()=>"https://liujinzhu333.github.io/album/"),h=e=>({name:e.originalname,filename:e.filename,url:`${$.value}${e.path}`,id:e.id,raw:e}),b=async()=>{const e=await E.getDataList("files");s.value=e.map(a=>h(a))},x=async e=>{_.value=!0;const a=await V.upload({file:e});return s.value.push(h(a.data)),!1},I=e=>{g.value={...e.raw},p.value=!0},L=async(e,a)=>{if(_.value)return _.value=!1,!1;try{await V.delFile({id:e.id,name:e.name,filename:e.filename}),s.value.splice(a,1)}catch{return console.log(e),!1}},F=e=>{n.value=e.url,r.value=!0};return b(),(e,a)=>{const d=f("el-icon"),P=f("el-upload"),B=f("el-dialog");return v(),m(z,null,[l(P,{"file-list":s.value,"onUpdate:fileList":a[0]||(a[0]=t=>s.value=t),"list-type":"picture-card","before-upload":x},{file:o(({file:t,index:D})=>[c("div",H,[c("img",{class:"el-upload-list__item-thumbnail",src:t.url,alt:""},null,8,J),c("span",M,[c("span",{class:"el-upload-list__item-preview",onClick:w=>F(t)},[l(d,null,{default:o(()=>[l(u(G))]),_:1})],8,Q),u(y)?(v(),m("span",{key:0,class:"el-upload-list__item-delete",onClick:w=>I(t)},[l(d,null,{default:o(()=>[l(u(K))]),_:1})],8,T)):k("",!0),u(y)?(v(),m("span",{key:1,class:"el-upload-list__item-delete",onClick:w=>L(t,D)},[l(d,null,{default:o(()=>[l(u(O))]),_:1})],8,W)):k("",!0)])])]),default:o(()=>[l(d,null,{default:o(()=>[l(u(j))]),_:1})]),_:1},8,["file-list"]),l(B,{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=t=>r.value=t)},{default:o(()=>[c("div",X,[c("img",{class:"view-img","w-full":"",src:n.value,alt:"Preview Image"},null,8,Y)])]),_:1},8,["modelValue"]),l(q,{visible:p.value,"onUpdate:visible":a[2]||(a[2]=t=>p.value=t),table:"files",data:g.value,onConfirm:b},null,8,["visible","data"])],64)}}}),le=R(Z,[["__scopeId","data-v-d18cbe68"]]);export{le as default};
