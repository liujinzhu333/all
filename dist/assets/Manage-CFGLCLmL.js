import"./FormItem.vue_vue_type_style_index_0_scoped_4a704015_lang-CYQfQxVe.js";import{m as y}from"./manageService-CK5DSoRL.js";import{d as G,r as w,z as W,o,c as V,e as _,u as I,f as p,g as B,h as t,i as Z,a as e,w as l,b as L,F as N,j as P,t as H,A as h,B as Q,C as ee,_ as le,l as ue}from"./index-NOxQLg1p.js";const M=!1,de={style:{display:"flex","align-items":"center","justify-content":"space-between"}},ie=G({__name:"Database",setup(z){const i=w(!1),C=async()=>{const{connected:r}=await y.getDatabaseConnectStatus();i.value=r},u=async()=>{const{connected:r}=await y.connectDatabase();i.value=r},g=async()=>{const{connected:r}=await y.closeConnection();i.value=r},m=r=>{r?u():g()};return W(()=>{C()}),(r,k)=>{const T=t("el-switch");return o(),V("div",de,[k[1]||(k[1]=_(" 数据库 ")),I(M)?(o(),p(T,{key:0,modelValue:i.value,"onUpdate:modelValue":k[0]||(k[0]=D=>i.value=D),onChange:m},null,8,["modelValue"])):B("",!0)])}}}),ce=["onClick"],me={style:{display:"flex",gap:"5px"}},re={key:0},_e={class:"dialog-footer"},pe=G({__name:"DataBaseTableNav",emits:["select"],setup(z,{emit:i}){const C=i,u=[{title:"cid",key:"cid",isEdit:!1},{title:"name",key:"name"},{title:"type",key:"type"},{title:"notnull",key:"notnull"},{title:"dflt_value",key:"dflt_value"},{title:"pk",key:"pk"}],g=w(),m=w([]),r=w([]),k=Z(()=>[...m.value,...r.value]),T=async()=>{const d=await y.getAllTable()||[];g.value=d},D=async d=>{await y.delTable(d),T()},O=d=>{C("select",d.name)},X=async()=>{if(!v.value.name)return;const d=k.value.filter(a=>a.isAdd);await y.addTable(v.value.name,v.value.title,d),T()},x=async()=>{const d=k.value.filter(a=>a.isAdd);await y.addTableColumn(v.value.name,d)},c=async d=>{m.value=await y.getTableInfo(d)},S=async()=>{await y.getAllDataJson()},$=w(!1),v=w({name:""}),E=w(""),R=()=>{$.value=!1,E.value="",r.value=[]},Y=d=>{d?(E.value=d.name,v.value={...d},c(d.name)):(v.value={name:""},m.value=[]),$.value=!0},j=async()=>{E.value?E.value!==v.value.name||await x():await X(),R()},q=()=>{r.value.push({isAdd:!0})};return W(()=>{T()}),(d,a)=>{const A=t("el-button"),F=t("el-text"),J=t("el-link"),n=t("el-input"),f=t("el-form-item"),b=t("el-option"),ae=t("el-select"),te=t("el-table-column"),ne=t("el-table"),oe=t("el-form"),se=t("el-dialog");return o(),V(N,null,[e(A,{size:"small",type:"primary",onClick:T},{default:l(()=>a[6]||(a[6]=[_("获取表")])),_:1}),I(M)?(o(),p(A,{key:0,size:"small",onClick:a[0]||(a[0]=s=>Y())},{default:l(()=>a[7]||(a[7]=[_("添加数据表")])),_:1})):B("",!0),I(M)?(o(),p(A,{key:1,size:"small",onClick:a[1]||(a[1]=s=>S())},{default:l(()=>a[8]||(a[8]=[_("导出")])),_:1})):B("",!0),L("div",null,[(o(!0),V(N,null,P(g.value,s=>(o(),V("div",null,[L("div",{class:"table-item",onClick:U=>O(s)},[e(F,{class:"mx-1"},{default:l(()=>[_(H(s.name),1)]),_:2},1024),L("div",me,[I(M)?(o(),p(J,{key:0,type:"primary",icon:I(h),onClick:Q(U=>Y(s),["stop"])},null,8,["icon","onClick"])):B("",!0),I(M)?(o(),p(J,{key:1,type:"danger",icon:I(ee),onClick:Q(U=>D(s.name),["stop"])},null,8,["icon","onClick"])):B("",!0)])],8,ce)]))),256))]),e(se,{modelValue:$.value,"onUpdate:modelValue":a[5]||(a[5]=s=>$.value=s),title:"添加数据表",width:"700","before-close":R},{footer:l(()=>[L("div",_e,[e(A,{onClick:a[4]||(a[4]=s=>$.value=!1)},{default:l(()=>a[10]||(a[10]=[_("取消")])),_:1}),e(A,{type:"primary",onClick:j},{default:l(()=>a[11]||(a[11]=[_(" 确定 ")])),_:1})])]),default:l(()=>[e(oe,{model:v.value,"label-width":"auto",style:{"max-width":"600px"}},{default:l(()=>[e(f,{label:"数据表"},{default:l(()=>[e(n,{modelValue:v.value.name,"onUpdate:modelValue":a[2]||(a[2]=s=>v.value.name=s)},null,8,["modelValue"])]),_:1}),e(f,{label:"数据表名"},{default:l(()=>[e(n,{modelValue:v.value.title,"onUpdate:modelValue":a[3]||(a[3]=s=>v.value.title=s)},null,8,["modelValue"])]),_:1}),e(ne,{data:k.value,style:{width:"100%"},border:""},{default:l(()=>[(o(),V(N,null,P(u,s=>e(te,{label:s.title,prop:s.key},{default:l(U=>[U.row.isAdd&&s.isEdit!==!1?(o(),V("div",re,[s.key==="type"?(o(),p(ae,{key:0,modelValue:U.row[s.key],"onUpdate:modelValue":K=>U.row[s.key]=K},{default:l(()=>[e(b,{value:"TEXT"}),e(b,{value:"CLOB"}),e(b,{value:"INTEGER"}),e(b,{value:"CHAR"}),e(b,{value:"NULL"}),e(b,{value:"REAL"}),e(b,{value:"BLOB"}),e(b,{value:"DATETIME"}),e(b,{value:"DATE"}),e(b,{value:"HHH"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):(o(),p(n,{key:1,modelValue:U.row[s.key],"onUpdate:modelValue":K=>U.row[s.key]=K},null,8,["modelValue","onUpdate:modelValue"]))])):(o(),p(F,{key:1},{default:l(()=>[_(H(U.row[s.key]),1)]),_:2},1024))]),_:2},1032,["label","prop"])),64))]),_:1},8,["data"]),e(A,{class:"mt-4",style:{width:"100%"},onClick:q},{default:l(()=>a[9]||(a[9]=[_(" 添加字段 ")])),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}}),ve=le(pe,[["__scopeId","data-v-040bc03e"]]),fe={class:"card-header"},ye={key:0},ke={class:"dialog-footer"},be=G({__name:"TableData",props:{name:{},tableInfoColumn:{}},setup(z){const i=z,C=w(),u=w({}),g=Z(()=>i.tableInfoColumn?i.tableInfoColumn:[]),m=async()=>{C.value=await y.getDataList(i.name,{})},r=async()=>{await y.addDataItem(i.name,u.value),m()},k=async()=>{await y.updateDataItem(i.name,u.value),m()},T=async x=>{await y.deleteDataItem(i.name,x.id),m()},D=w(!1),O=x=>{u.value=x?{...x}:{},D.value=!0},X=async()=>{u.value.id?await k():await r(),D.value=!1};return ue(()=>i.name,()=>m()),m(),(x,c)=>{const S=t("el-button"),$=t("el-link"),v=t("el-text"),E=t("el-table-column"),R=t("el-table"),Y=t("el-card"),j=t("el-input"),q=t("el-option"),d=t("el-select"),a=t("el-date-picker"),A=t("el-form-item"),F=t("el-form"),J=t("el-dialog");return o(),V(N,null,[e(Y,{shadow:"always",title:""},{header:l(()=>[L("div",fe,[L("span",null,"数据表("+H(x.name)+")数据",1)])]),default:l(()=>[I(M)?(o(),p(S,{key:0,onClick:c[0]||(c[0]=n=>O())},{default:l(()=>c[3]||(c[3]=[_("添加")])),_:1})):B("",!0),e(R,{data:C.value,style:{width:"100%"},border:""},{default:l(()=>[(o(!0),V(N,null,P(g.value,n=>(o(),p(E,{label:n.title,prop:n.key},{default:l(f=>[n.key==="action"?(o(),V("div",ye,[e($,{type:"primary",icon:I(h),onClick:b=>O(f.row)},{default:l(()=>c[4]||(c[4]=[_(" 修改 ")])),_:2},1032,["icon","onClick"]),e($,{type:"danger",icon:I(ee),style:{"margin-left":"10px"},onClick:b=>T(f.row)},{default:l(()=>c[5]||(c[5]=[_(" 删除 ")])),_:2},1032,["icon","onClick"])])):(o(),p(v,{key:1},{default:l(()=>[_(H(f.row[n.key]),1)]),_:2},1024))]),_:2},1032,["label","prop"]))),256))]),_:1},8,["data"])]),_:1}),e(J,{modelValue:D.value,"onUpdate:modelValue":c[2]||(c[2]=n=>D.value=n)},{footer:l(()=>[L("div",ke,[e(S,{onClick:c[1]||(c[1]=n=>D.value=!1)},{default:l(()=>c[6]||(c[6]=[_("取消")])),_:1}),e(S,{type:"primary",onClick:X},{default:l(()=>c[7]||(c[7]=[_(" 确定 ")])),_:1})])]),default:l(()=>[e(F,{model:u.value,"label-width":"auto",style:{"max-width":"600px"}},{default:l(()=>[(o(!0),V(N,null,P(x.tableInfoColumn,n=>(o(),p(A,{label:n.title},{default:l(()=>[_(H(n)+" ",1),n.type==="CLOB"?(o(),p(j,{key:0,modelValue:u.value[n.key],"onUpdate:modelValue":f=>u.value[n.key]=f,rows:2,type:"textarea",placeholder:"Please input"},null,8,["modelValue","onUpdate:modelValue"])):n.type==="CHAR"?(o(),p(d,{key:1,modelValue:u.value[n.key],"onUpdate:modelValue":f=>u.value[n.key]=f,placeholder:"Select"},{default:l(()=>[e(q,{label:"测试",value:"ce"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):n.type==="DATETIME"?(o(),p(a,{key:2,modelValue:u.value[n.key],"onUpdate:modelValue":f=>u.value[n.key]=f,type:"date","value-format":"YYYY-MM-DD",placeholder:"Pick a day"},null,8,["modelValue","onUpdate:modelValue"])):(o(),p(j,{key:3,modelValue:u.value[n.key],"onUpdate:modelValue":f=>u.value[n.key]=f,disabled:n.key==="id"},null,8,["modelValue","onUpdate:modelValue","disabled"]))]),_:2},1032,["label"]))),256))]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}}),we={class:"manage-page"},Ce=G({__name:"Manage",setup(z){const i=w(),C=w({name:"",list:[]}),u=async g=>{C.value.list=await y.getTableInfo(g),C.value.name=g,i.value=C.value.list.map(m=>({title:m.name,key:m.name,type:m.type}))};return(g,m)=>{const r=t("el-card"),k=t("el-col"),T=t("el-row");return o(),V("div",we,[e(T,{gutter:20},{default:l(()=>[e(k,{span:6},{default:l(()=>[e(r,{shadow:"always"},{header:l(()=>[e(ie)]),default:l(()=>[e(ve,{onSelect:u})]),_:1})]),_:1}),e(k,{span:18},{default:l(()=>[e(be,{name:C.value.name,tableInfoColumn:i.value},null,8,["name","tableInfoColumn"])]),_:1})]),_:1})])}}}),Ie=le(Ce,[["__scopeId","data-v-1db595b0"]]);export{Ie as default};
