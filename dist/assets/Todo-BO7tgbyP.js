import{M as w,N as Y,O as S,P as Z,Q as z,B as H,G as N,R as B,A as q,S as tt,u as h,T as et,d as ot,r as V,c as O,a as y,w as C,U as j,m as b,V as at,W as nt,e as E,X as st,Y as R,h as D,F as W,s as lt,f as L,g as it,Z as ut,$ as rt,t as F,b as $,j as G,o as x,_ as ct}from"./index-CmVGz_EG.js";function J(t,e){return Z()?(z(t,e),!0):!1}const P=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const dt=Object.prototype.toString,pt=t=>dt.call(t)==="[object Object]";function ft(t){let e;function n(){return e||(e=t()),e}return n.reset=async()=>{const d=e;e=void 0,d&&await d},n}function M(t){return Array.isArray(t)?t:[t]}function vt(t,e,n={}){const{immediate:d=!0,immediateCallback:f=!1}=n,c=w(!1);let i;function a(){i&&(clearTimeout(i),i=void 0)}function s(){c.value=!1,a()}function l(...u){f&&t(),a(),c.value=!0,i=setTimeout(()=>{c.value=!1,i=void 0,t(...u)},S(e))}return d&&(c.value=!0,P&&l()),J(s),{isPending:Y(c),start:l,stop:s}}function mt(t,e,n){return H(t,e,{...n,immediate:!0})}const yt=P?window:void 0,K=P?window.navigator:void 0;function gt(t){var e;const n=S(t);return(e=n==null?void 0:n.$el)!==null&&e!==void 0?e:n}function Q(...t){const e=[],n=()=>{e.forEach(a=>a()),e.length=0},d=(a,s,l,u)=>(a.addEventListener(s,l,u),()=>a.removeEventListener(s,l,u)),f=N(()=>{const a=M(S(t[0])).filter(s=>s!=null);return a.every(s=>typeof s!="string")?a:void 0}),c=mt(()=>{var a,s;return[(a=(s=f.value)===null||s===void 0?void 0:s.map(l=>gt(l)))!==null&&a!==void 0?a:[yt].filter(l=>l!=null),M(S(f.value?t[1]:t[0])),M(h(f.value?t[2]:t[1])),S(f.value?t[3]:t[2])]},([a,s,l,u])=>{if(n(),!(a!=null&&a.length)||!(s!=null&&s.length)||!(l!=null&&l.length))return;const m=pt(u)?{...u}:u;e.push(...a.flatMap(k=>s.flatMap(p=>l.map(v=>d(k,p,v,m)))))},{flush:"post"}),i=()=>{c(),n()};return J(n),i}function _t(){const t=w(!1),e=tt();return e&&q(()=>{t.value=!0},e),t}function X(t){const e=_t();return N(()=>(e.value,!!t()))}function U(t,e={}){const{controls:n=!1,navigator:d=K}=e,f=X(()=>d&&"permissions"in d),c=w(),i=typeof t=="string"?{name:t}:t,a=w(),s=()=>{var u,m;a.value=(u=(m=c.value)===null||m===void 0?void 0:m.state)!==null&&u!==void 0?u:"prompt"};Q(c,"change",s,{passive:!0});const l=ft(async()=>{if(f.value){if(!c.value)try{c.value=await d.permissions.query(i)}catch{c.value=void 0}finally{s()}if(n)return et(c.value)}});return l(),n?{state:a,isSupported:f,query:l}:a}function ht(t={}){const{navigator:e=K,read:n=!1,source:d,copiedDuring:f=1500,legacy:c=!1}=t,i=X(()=>e&&"clipboard"in e),a=U("clipboard-read"),s=U("clipboard-write"),l=N(()=>i.value||c),u=w(""),m=w(!1),k=vt(()=>m.value=!1,f,{immediate:!1});async function p(){let r=!(i.value&&T(a.value));if(!r)try{u.value=await e.clipboard.readText()}catch{r=!0}r&&(u.value=I())}l.value&&n&&Q(["copy","cut"],p,{passive:!0});async function v(r=S(d)){if(l.value&&r!=null){let o=!(i.value&&T(s.value));if(!o)try{await e.clipboard.writeText(r)}catch{o=!0}o&&_(r),u.value=r,m.value=!0,k.start()}}function _(r){const o=document.createElement("textarea");o.value=r,o.style.position="absolute",o.style.opacity="0",document.body.appendChild(o),o.select(),document.execCommand("copy"),o.remove()}function I(){var r,o,g;return(r=(o=document)===null||o===void 0||(g=o.getSelection)===null||g===void 0||(g=g.call(o))===null||g===void 0?void 0:g.toString())!==null&&r!==void 0?r:""}function T(r){return r==="granted"||r==="prompt"}return{isSupported:l,text:B(u),copied:B(m),copy:v}}const Ct={style:{"max-width":"1000px",margin:"0 auto"}},bt={class:"list-filter"},xt=["onClick"],St={style:{display:"flex","align-items":"center",gap:"4px"}},wt={class:"right-action"},kt=ot({__name:"Todo",setup(t){const{copy:e}=ht(),n=V(""),d=V("all"),f=V([{id:0,title:"todo页面",status:1}]),c=[{label:"全部",value:"all"},{label:"未完成",value:1},{label:"已完成",value:2},{label:"已归档",value:3}];async function i(){const p=await b.getDataList("todos",{status:d.value==="all"?[1,2]:d.value});f.value=p||[]}async function a(){await b.addDataItem("todos",{title:n.value,status:1}),n.value="",i()}async function s(){const p=await b.getOfflineData("todos");e(JSON.stringify(p))}async function l(){const p=await navigator.clipboard.readText(),v=JSON.parse(p)||[];for(const _ of v)_.add?b.addDataItem("todos",{title:_.title,status:_.status}):b.updateDataItem("todos",_)}async function u(p){await b.deleteDataItem("todos",p),i()}async function m(p){await b.updateDataItem("todos",{...p,status:p.status===1?2:1}),i()}async function k(p){await b.updateDataItem("todos",{...p,status:3}),i()}return q(()=>{i()}),(p,v)=>{const _=$("ElText"),I=$("DocumentChecked"),T=$("el-icon"),r=$("Close");return x(),O("div",Ct,[y(h(j),null,{default:C(()=>[y(h(at),{clearable:"",placeholder:"创建待办项",modelValue:n.value,"onUpdate:modelValue":v[0]||(v[0]=o=>n.value=o),onKeydown:nt(a,["enter"])},null,8,["modelValue"])]),_:1}),y(h(j),{class:"list-box"},{default:C(()=>[E("div",bt,[y(h(st),{modelValue:d.value,"onUpdate:modelValue":v[1]||(v[1]=o=>d.value=o),placeholder:"默认",options:c,style:{width:"100px"},onChange:i},null,8,["modelValue"]),y(h(R),{type:"primary",onClick:s},{default:C(()=>v[2]||(v[2]=[D("复制")])),_:1}),y(h(R),{type:"primary",onClick:l},{default:C(()=>v[3]||(v[3]=[D("粘贴")])),_:1})]),(x(!0),O(W,null,lt(f.value,(o,g)=>(x(),O(W,{key:g},[g!=0?(x(),L(h(ut),{key:0,style:{margin:"10px 0"}})):it("",!0),E("div",{onClick:A=>m(o),style:{height:"32px",display:"flex","align-items":"center","justify-content":"space-between",padding:"5px 0"}},[E("div",St,[y(h(rt),{"model-value":o.status,"true-value":2},null,8,["model-value"]),o.status===2?(x(),L(_,{key:0,tag:"del",type:"info",style:{cursor:"pointer"}},{default:C(()=>[D(F(o.title),1)]),_:2},1024)):(x(),L(_,{key:1,style:{cursor:"pointer"}},{default:C(()=>[D(F(o.title),1)]),_:2},1024))]),E("div",wt,[y(T,{style:{cursor:"pointer"},onClick:G(A=>k(o),["stop"])},{default:C(()=>[y(I)]),_:2},1032,["onClick"]),y(T,{style:{cursor:"pointer"},onClick:G(A=>u(o.id),["stop"])},{default:C(()=>[y(r)]),_:2},1032,["onClick"])])],8,xt)],64))),128))]),_:1})])}}}),Et=ct(kt,[["__scopeId","data-v-bf2e275f"]]);export{Et as default};
